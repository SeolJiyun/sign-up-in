<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Sign up</title>
    <script src="https://code.jquery.com/jquery-2.2.4.js"></script>
</head>

<style>
    input:focus {
        outline: none;
    }

    span {
        color: red;
    }
</style>

<body>
    <div id="all">
        <!-- 숨기기, 보이기 버튼 -->
        <div id="hide_show">
            <button type="button" id="hide" style="width: 100px; height: 50px;">숨기기</button>
            <button type="button" id="show" style="width: 100px; height: 50px;" hidden>보이기</button>
        </div>

        <!-- 회원가입 폼 -->
        <div id="signup_all">
            <form action="" accept-charset="UTF-8" id="signup_form" name="signup" method="post"
                onsubmit="return check()">
                <br>
                <fieldset style="width: 400px;">
                    <h1>회원가입</h1>
                    <div id="name">
                        * 이름 <span></span><br>
                        <input type="text" class="user" id="username" name="username" value="" size="20" required /><br>
                    </div>
                    <div id="id">
                        * 아이디 <span></span><br>
                        <input type="text" class="user" id="userid" name="userid" value="" size="20" required /><br>
                    </div>
                    <div id="pw">
                        * 비밀번호 <span></span><br>
                        <input type="password" class="user" id="userpw" name="userpw" id="userpw" value="" size="20"
                            required /><br>
                    </div>
                    <div id="pwc">
                        * 비밀번호 확인 <span></span><br>
                        <input type="password" class="user" id="userpwc" name="userpwc" id="userpwc" value="" size="20"
                            required />
                        <button id="pwc_btn" type="button">확인</button><br>
                    </div>
                    <div id="mail">
                        * 이메일 <span></span><br>
                        <input type="email" class="user" id="useremail" name="useremail" value="" size="20"
                            required /><br>
                    </div>
                    기타 (선택)<br>
                    <textarea class="user" id="textView" style="width:300px; height:100px; border:solid 1px"
                        oncopy="return false" oncut="return false" onpaste="return false"></textarea><br>
                    <div>
                        <input type="submit" id="submit_btn" value="가입하기" />
                        <input type="reset" id="reset_btn" value="초기화" />
                    </div>
        </div>
        </fieldset>
        </form><br>

        <!-- 결과 출력 -->
        <div id="user_inform" hidden>
            <table border="1" width="400px">
                <th width="20%">요소</th>
                <th width="80%">가입정보</th>
                <tr>
                    <td>이름</td>
                    <td id="tdname"></td>
                </tr>
                <tr>
                    <td>아이디</td>
                    <td id="tdid"></td>
                </tr>
                <tr>
                    <td>비밀번호</td>
                    <td id="tdpw"></td>
                </tr>
                <tr>
                    <td>이메일</td>
                    <td id="tdmail"></td>
                </tr>
                <tr>
                    <td>기타</td>
                    <td id="tdtext"></td>
                </tr>
            </table>
        </div>
    </div>
    </div>

    <script>
        $(document).ready(function () {

            //비밀번호 확인 버튼 눌렀을 때
            $("#pwc_btn").click(function () {
                pw_btn_check();
            });
            $("#userpwc").change(function () {
                pw_btn_check();
            });
            $("#userpw").change(function () {
                pw_btn_check();
            });

            //기타란 복붙금지
            $("#textView").bind('paste', function (e) {
                alert("붙여넣기 금지");
            });
            $("#textView").bind('copy', function (e) {
                alert("복사 금지");
            });
            $("#textView").bind('cut', function (e) {
                alert("잘라내기 금지");
            });

            // 숨기기 버튼
            $("#hide").click(function () {
                $('#signup_all').hide();
                $(this).hide();
                $("#show").show();
                $("#signup_form").each(function () {
                    this.reset();
                });
                $("#signup_all").find('input').removeAttr("style");
                $("#signup_all").find('span').text("");
                $("#user_inform").hide();
            });

            // 보이기 버튼
            $("#show").click(function () {
                $('#signup_all').show();
                $(this).hide();
                $("#hide").show();
            });

            //메일 확인
            $("#useremail").change(function () {
                var umail = $(this).val();
                mail_check(umail);
            });

            //input 클릭했을 때
            $("input").focus(function () {
                var it = $(this);
                if (it.attr('id') != 'submit_btn' && it.attr('id') != 'reset_btn') {
                    it.val("");
                    empty_x(it);
                }
            });

            //input에 값을 넣고있을 때 필수입력사항체크
            $("input").keyup(function () {
                var it = $(this);
                empty_x(it);
            });

            //초기화 버튼 눌렸을 때
            $("#reset_btn").click(function () {
                $("#signup_all").find('input').removeAttr("style");
                $("#signup_all").find('span').text("");
                $("#signup_all").find('input').blur();
            })
        });


        // 함수////////////////////////////////////////////

        //가입하기 버튼 눌렀을 때, form 최종확인하는 함수
        function check() {
            if (window.confirm('회원가입 폼을 제출하시겠습니까? 작성된 내용은 제출 후 초기화됩니다.')) {
                if (pw_check() != true) {
                    alert("비밀번호를 확인하세요")
                    $("#pwc_btn").click();
                    return false;
                } else if (mail_check($("#useremail").val()) != true) {
                    alert("이메일 형식을 확인하세요")
                    return false;
                } else {
                    submit_success();
                    return false;
                }

            }
            return false;

        }

        // 가입성공 시 테이블 출력
        function submit_success() {
            $("#user_inform").show();
            $("#tdname").text($("#username").val());
            $("#tdid").text($("#userid").val());
            $("#tdpw").text($("#userpw").val());
            $("#tdmail").text($("#useremail").val());
            if ($("#textView").val() == '') {
                $("#tdtext").text("-");
            } else {
                $("#tdtext").text($("#textView").val());
            }
            $("#reset_btn").click();
        }

        // 메일 정규식 확인
        function mail_check(umail) {
            var phoneNumberRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i;
            if (!phoneNumberRegex.test(umail)) {
                red_input($("#useremail"));
                $("#useremail").parent().find('span').text("이메일 형식을 다시 확인하세요");
                return false;
            } else {
                green_input($("#useremail"));
                $("#useremail").parent().find('span').text("");
                return true;
            }
        }

        // 비밀번호 확인 함수
        function pw_check() {
            var upw = $("#userpw").val();
            var upwc = $('#userpwc').val();
            if (upw == '') {
                return "enterPW";
            } else if (upwc == '') {
                return "enterPWC";
            } else if (upw !== upwc) {
                return "notMatch";
            } else {
                return true;
            }
        }

        // 비밀번호 확인 버튼 눌렀을 때
        function pw_btn_check() {
            var pwck = pw_check();
            if (pwck == "enterPW") {
                red_input("#userpw");
                $("#userpw").focus();
            } else if (pwck == "enterPWC") {
                red_input("#userpwc");
                $("#userpwc").focus();
            } else if (pwck == "notMatch") {
                red_input("#userpw");
                red_input("#userpwc");
                $("#userpw").focus();
                $(("#userpwc")).parent().find('span').text("비밀번호가 일치하지 않습니다").css("color", "red");
            } else if (pwck == true) {
                green_input("#userpw");
                green_input("#userpwc");
                $(("#userpw")).parent().find('span').text("");
                $(("#userpwc")).parent().find('span').text("비밀번호 일치").css("color", "green");
            }
        }

        // 필수입력사항체크
        function empty_x(it) {
            if (it.val() == "") {
                red_input(it);
                it.parent().find('span').text("필수입력사항 입니다").css("color", "red");
                return false;
            } else {
                it.parent().find('span').text("");
                if (it.attr('id') == "username" || it.attr('id') == "userid") {
                    green_input(it);
                }
                return true;
            }
        }

        // input 빨간 테두리, 배경색
        function red_input(x) {
            $(x).css("border", "3px solid red");
            $(x).css("background-color", "pink");
            $(x).css("border-radius", "5px / 5px");
        }
        // input 초록 테두리, 배경색
        function green_input(x) {
            $(x).css("border", "3px solid green");
            $(x).css("background-color", "lightgreen");
            $(x).css("border-radius", "5px / 5px");
        }

    </script>
</body>

</html>